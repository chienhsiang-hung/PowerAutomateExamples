FUNCTION Outlook GLOBAL
    Outlook.Launch Instance=> OutlookInstance
    DISABLE Outlook.RetrieveEmailMessages.RetrieveEmails Instance: OutlookInstance Account: $'''hsiang.hung@fubon.com''' MailFolder: $'''inbox''' EmailsToRetrieve: Outlook.RetrieveMessagesMode.Unread MarkAsRead: False ReadBodyAsHtml: False FromContains: $'''hsiang.hung@fubon.com''' Messages=> RetrievedEmails2
    DISABLE Outlook.SendEmailThroughOutlook.SendEmail Instance: OutlookInstance Account: $'''hsiang.hung@fubon.com''' SendTo: $'''hsiang.hung@fubon.com''' Subject: 123 Body: 456 IsBodyHtml: False IsDraft: False
    Outlook.RetrieveEmailMessages.RetrieveEmails Instance: OutlookInstance Account: $'''hsiang.hung@fubon.com''' MailFolder: $'''inbox''' EmailsToRetrieve: Outlook.RetrieveMessagesMode.Unread MarkAsRead: False ReadBodyAsHtml: False FromContains: $'''hsiang.hung@fubon.com''' Messages=> RetrievedEmails
    SET NewVar6 TO RetrievedEmails[1].Body
    DISABLE LOOP WHILE (1) = (1)
    DISABLE END
    LOOP WHILE (RetrievedEmails[0].Subject) <> ($'''Hi''')
        Outlook.RetrieveEmailMessages.RetrieveEmails Instance: OutlookInstance Account: $'''hsiang.hung@fubon.com''' MailFolder: $'''inbox''' EmailsToRetrieve: Outlook.RetrieveMessagesMode.Unread MarkAsRead: False ReadBodyAsHtml: False FromContains: $'''hsiang.hung@fubon.com''' Messages=> RetrievedEmails
    END
    Outlook.RespondToMailMessage.ReplyToEmail Instance: OutlookInstance Account: $'''hsiang.hung@fubon.com''' MailMessage: RetrievedEmails[0] Body: $'''OK'''
END FUNCTION